# version: '3.8'

# services:
#   web:
#     build: .
#     ports:
#       - "8081:8081"
#     networks:
#       - netaid
#     volumes:
#       - .:/task-management

#   mysql:
#     image: mysql:5.7
#     environment:
#       MYSQL_ROOT_PASSWORD: Nitesh@123
#       MYSQL_DATABASE: task_management
#     ports:
#       - "3307:3307"
#     networks:
#       - netaid

#   nginx:
#     image: nginx:latest
#     ports:
#       - "80:80"
#     networks:
#       - netaid
#     volumes:
#       - ./nginx.conf:/etc/nginx/nginx.conf
#     depends_on:
#       - web

# networks:
#   netaid:
#     driver: bridge



# version: '3.8'

# services:
#   web:
#     build: .
#     ports:
#       - "9091:9091"
#     networks:
#       - netaid
#     volumes:
#       - .:/task-management

#   mysql:
#     image: mysql:5.7
#     environment:
#       MYSQL_ROOT_PASSWORD: Nitesh@123
#       MYSQL_DATABASE: task_management
#     ports:
#       - "3307:3306"
#     networks:
#       - netaid

#   nginx:
#     image: nginx:latest
#     ports:
#       - "80:80"
#     networks:
#       - netaid
#     volumes:
#       - ./nginx.conf:/etc/nginx/nginx.conf
#     depends_on:
#       - web

# networks:
#   netaid:
#     driver: bridge


# version: '3.8'

# services:
#   task-management-web:
#     build: .
#     ports:
#       - "9092:9091"
#     networks:
#       - task-management-network
#     volumes:
#       - .:/task-management
#     environment:
#       # Load environment variables from a separate file (`.env`)
#       - SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/task_management?createDatabaseIfNotExist=true
#       - SPRING_DATASOURCE_USERNAME:root
#       # Avoid storing password directly in the file (use `.env`)
#       - SPRING_DATASOURCE_PASSWORD:Nitesh@123
#       - SPRING_DATASOURCE_DRIVER_CLASS_NAME:com.mysql.cj.jdbc.Driver
#       - SPRING_JPA_HIBERNATE_DDL_AUTO:update
#       - SPRING_JPA_PROPERTIES_HIBERNATE_DIALECT:org.hibernate.dialect.MySQL57Dialect
#       - SERVER_PORT:9090

#   mysql:
#     image: mysql:5.7
#     environment:
#       MYSQL_ROOT_PASSWORD:Nitesh@123
#       # Avoid storing password directly in the file (use `.env`)
#       MYSQL_DATABASE: task_management
#     ports:
#       - "3307:3306"
#     networks:
#       - task-management-network

#   nginx:
#     image: nginx:latest
#     ports:
#       - "80:80"
#     networks:
#       - task-management-network
#     volumes:
#       - ./nginx.conf:/etc/nginx/nginx.conf
#     depends_on:
#       - task-management-web

# networks:
#   task-management-network:
#     driver: bridge


# docker-compose.yml
version: '3.8'

services:
  task-management-web:
    build: .
    ports:
      - "9090:9090"
    networks:
      - task-management-network
    volumes:
      - .:/task-management
    environment:
      # MySQL Properties
      spring.datasource.url=jdbc:mysql://localhost:3306/task_management?createDatabaseIfNotExist=true
      spring.datasource.username=root
      spring.datasource.password=Nitesh@123
      spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
      spring.jpa.hibernate.ddl-auto=update
      spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL5Dialect
      
      # View Resolver Properties
      spring.mvc.view.prefix=/WEB-INF/view/
      spring.mvc.view.suffix=.jsp

    
  mysql:
    image: mysql:5.7
    environment:
      - MYSQL_ROOT_PASSWORD=Nitesh@123
      - MYSQL_DATABASE=task_management
    ports:
      - "3307:3306"
    networks:
      - task-management-network

  nginx:
    image: nginx:latest
    ports:
      - "80:80"
    networks:
      - task-management-network
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - task-management-web

networks:
  task-management-network:
    driver: bridge
